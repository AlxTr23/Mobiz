/*
 * FDPClient Hacked Client
 * A free open source mixin-based injection hacked client for Minecraft using Minecraft Forge by LiquidBounce.
 * https://github.com/SkidderMC/FDPClient/
 */
package net.ccbluex.liquidbounce.features.module.modules.exploit

import me.zywl.fdpclient.FDPClient
import me.zywl.fdpclient.event.EventTarget
import me.zywl.fdpclient.event.UpdateEvent
import net.ccbluex.liquidbounce.features.module.ModuleCategory
import net.ccbluex.liquidbounce.features.module.ModuleInfo
import net.ccbluex.liquidbounce.utils.MinecraftInstance.mc
import net.ccbluex.liquidbounce.utils.render.ColorUtils.stripColor
import net.minecraft.util.EnumChatFormatting
import net.ccbluex.liquidbounce.features.module.Module
import java.util.*

@ModuleInfo(name = "AutoAddStaffs", category = ModuleCategory.EXPLOIT)
class AutoAddStaffs : Module() {
    private fun isStaff(prefix: String): Boolean {
        return Arrays.asList(*STAFF_PREFIXES).contains(stripColor(prefix))
    }

    @EventTarget
    fun handle(event: UpdateEvent?) {
        val friendManager = FDPClient.fileManager.friendsConfig

        // Loops through every team registered by the server
        for (team in mc.theWorld.scoreboard.teams) {
            // If it's staff
            if (this.isStaff(team.colorPrefix)) {
                // Loops through every member of the team
                for (member in team.membershipCollection) {
                    // If the member isn't a friend
                    if (!friendManager.isFriend(member)) {
                        friendManager.addFriend(member)

                        chat("ยง6ยงl Added: " + team.colorPrefix + member)
                        chat(EnumChatFormatting.RED.toString() + "L" + EnumChatFormatting.RED + "e" + EnumChatFormatting.RED + "a" + EnumChatFormatting.RED + "k" + EnumChatFormatting.RED + "e" + EnumChatFormatting.RED + "d" + EnumChatFormatting.RED + " " + EnumChatFormatting.RED + "b" + EnumChatFormatting.RED + "y" + EnumChatFormatting.RED + " " + EnumChatFormatting.RED + "L" + EnumChatFormatting.RED + "o" + EnumChatFormatting.RED + "p" + EnumChatFormatting.RED + "e" + EnumChatFormatting.RED + "$")
                    }
                }
            }
        }
    }

    companion object {
        private val STAFF_PREFIXES = arrayOf( // This can and should be made choosable by the user.
            "[Moderador] ",
            "[Supervisor]",
            "[Moderador+] ",
            "[Administrador] ",
            "[Admin] ",
            "[Coordenador] ",
            "[Coord] ",
            "[Gerente] ",
            "[CEO] ",
            "[Dono] ",
            "[Diretor] ",
            "[Master] "
        )
    }
}